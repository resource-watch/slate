# Geostore

## What is Geostore

If you are new to the RW API, or want to learn more about the concept of a geostore, we strongly encourage you to read the [geostore concept](#geostore) documentation first. It gives you a brief and clear description of what a geostore is, and what it can do for you.

Once you've read that section, you can come back here to learn more details about using the RW API Geostore feature, which aims to provide a comprehensive way to communicate geographic vector-data structures described using [GeoJSON](https://en.wikipedia.org/wiki/GeoJSON) between platforms and microservices.

[Geostore objects](/index-rw.html#what-are-geostore-objects), describing things like the boundaries of countries, protected areas or land use types, have been uploaded by [WRI](https://www.wri.org/), its partner organizations, or by API users like you. They are particularly useful for combining with the range of [datasets](#dataset) available in the RW API, for example to create national summaries or for making a specific analysis within your own user-defined region.

To find out more about accessing the geostore objects already available on the RW API, check out the documentation on [getting geostore objects](#getting-geostore-objects). A quick, visual way to view an existing geostore is by using the [`/geostore/:id/view`](#get-geostore-by-geostore-id-and-view-at-geojson-io) endpoint.

You can also [create you own geostore objects](#create-a-geostore-object) on the RW API, if you'd like to share your data with the world, or if you are looking to use the RW API and its features to gain insights into your data.

## What are Geostore objects

Geostore objects contain [GeoJSON](https://en.wikipedia.org/wiki/GeoJSON) `FeatureCollection` objects (`geojson`), with a single `Feature` whose `Geometry` has been checked for geometric validity, and have been assigned an identifier (`id`, `hash`) upon creation.

This identifier is a 128-bit hash generated by passing the [pre-processed GeoJSON string](#geostore) through the [MD5 message-digest algorithm](https://en.wikipedia.org/wiki/MD5). This means that each identifier is a unique fingerprint of the GeoJSON string.

So if you add an exact copy of your GeoJSON string it will generate the same hash, but if the GeoJSON string is changed in any way it will have a different hash. Hence, the Geostore identifier provides the RW API a way to ensure that platforms and microservices are using *exactly* the same geographic structures. *Note changes in the Geostore id may also represent changes in other  GeoJSON properties, not only the `Geometry`*

To prevent overwriting of existing geostore objects, they contain a field indicated if the object is locked to editing (`lock`); which can be [set when creating geostore objects](#create-a-geostore-object).

Also, during object creation the minimum bounding box enclosing all geometries in the GeoJSON (`bbox`), and, if the geometries are type (Multi) Polygon, total surface area in hectares of the geometries (`areaHa`) are added to the geostore. *Note these values are not calculated if supplied when creating a geostore.*

Geostore objects can also be [created by getting a GeoJSON from provider API](#create-using-a-provider-definition); in which case the geostore will also include an object which gives information used to connect to the provider data source (`provider`). At present the only provider definition supported is a [Carto](https://carto.com/) table, using  `"type": "carto"`.

Finally, all geostore objects have a property for storing application specific attributes (`info`), which has no formalized schema. Here, fields used for indexing, and metadata, related to use on different platforms are added.

> Overview of a geostore object

| Field      | Type   | Description                                                                                                                                                                                                                                           |
|------------|--------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| `id`       | string | A unique identifier for the geostore object in the form of a 128 bit [MD5 hash](https://en.wikipedia.org/wiki/MD5) generated from the GeoJSON object.                                                                                                 |
| `hash`     | string | A unique identifier for the geostore object in the form of a 128 bit [MD5 hash](https://en.wikipedia.org/wiki/MD5) generated from the GeoJSON object.                                                                                                 |
| `geojson`  | object | A valid `FeatureCollection`, `Feature`, or `Geometry` [GeoJSON](https://geojson.org/) object.                                                                                                                                                         |
| `provider` | object | Optional [provider definition](#create-using-a-provider-definition) used to fetch GeoJSON data from APIs.                                                                                                                                             |
| `lock`     | string | Optional indication if the object is locked for editing                                                                                                                                                                                               |
| `areaHa`   | number | Optional total surface area in hectares of all Polygon and MultiPolygon geometries in the GeoJSON object.                                                                                                                                             |
| `bbox`     | array  | Array describing the [minimum bounding box](https://en.wikipedia.org/wiki/Minimum_bounding_box) enclosing all of the geometries in the GeoJSON object, expressed as an array of the form min Longitude , min Latitude , max Longitude , max Latitude. |
| `info`     | object | Object that defines application specific properties, for example used for indexing or related to editing of the geostore object.                                                                                                                      |

## Overview of available endpoints

The Geostore API consists of a number of endpoints to help users interact with geostore objects. Many of them are essentially helpers to make it easy to access geometries from useful data sources, such as:

- **Administrative areas** (countries, regions, ect.) from the [Database of Global Administrative Areas (GADM)](https://en.wikipedia.org/wiki/GADM).
- **Protected areas** (world heritage sites, national parks, ect.) from the [The World Database on Protected Areas](https://www.protectedplanet.net/c/world-database-on-protected-areas).
- **Land activity/use types** (logging, mining, ect.) from the [WRI](https://www.wri.org/) [managed forest](https://data.globalforestwatch.org/datasets/managed-forest-concessions), [mining](https://data.globalforestwatch.org/datasets/mining-concessions), and [oil palm](https://data.globalforestwatch.org/datasets/20398d4dc36e47bd92b559786670f270_1) concessions, and [WWF](https://wwf.panda.org)/[RESOLVE](https://www.resolve.ngo/about.htm) [tiger conservation](https://data.globalforestwatch.org/datasets/tiger-conservation-landscapes) datasets.  

As these data sets are periodically updated, these "helper" endpoints are updated to use the latest data. So unless you really need an older version of a data set, such as GADM, you should always use the latest endpoint version. See the table below to get an overview of what can be done; click on the description to get more details.

> Comparison of endpoint versions

| Version | Description       |
|---------|------------------ |
| `v1`    | GADM version 2.8. |
| `v2`    | GADM version 3.6. |

> Overview of endpoints

| Method | Path                                | Description                                                                   |
|--------|-------------------------------------|------------------------------------------------------------------------------ |
| POST   | `/v1/geostore`                      | [Create a geostore object](#create-a-geostore-object)                         |
| GET    | `/v2/geostore/:id`                  | [Get a geostore object by Geostore id](#get-a-geostore-object-by-geostore-id) |
| POST   | `/v2/geostore/find-by-ids`          | [Get geostore objects by Geostore ids](#get-geostore-objects-by-geostore-ids) |
| GET    | `/v2/geostore/:id/view`             | [Get a geostore object by Geostore id and view at GeoJSON.io](#get-a-geostore-object-by-geostore-id-and-view-at-geojson-io) |
| GET    | `/v2/geostore/admin/list`           | [Get all Geostore ids, names and country codes](#get-all-geostore-ids-names-and-country-codes) |
| GET    | `/v2/geostore/admin/:iso`           | [Get a geostore object by country code](#get-country-code)                    |
| GET    | `/v2/geostore/admin/:iso/:id1`      | [Get a geostore object by country code and GADM admin 1 id](#get-a-geostore-object-by-country-code-and-gadm-admin-1-id) |
| GET    | `/v2/geostore/admin/:iso/:id1/:id2` | [Get a geostore object by country code, GADM admin 1 and admin 2 ids](#get-geostore-by-country-code-gadm-admin-1-and-admin-2-ids) |
| GET    | `/v2/geostore/wdpa/:id`             | [Get a geostore object by WDPA id](#get-a-geostore-object-by-wdpa-id)         |
| GET    | `/v2/geostore/use/:name/:id`        | [Get a geostore object by Land Use Type name and id](#get-a-geostore-object-by-land-use-type-name-and-id) |
| POST   | `/v1/geostore/area`                 | [Calculate the area of a provided Geostore object](#calculate-the-area-of-a-geostore-object) |

## Create a geostore object

Geostore objects can be created in the RW API Geostore using a valid GeoJSON object or by selecting a row from a [Carto](https://carto.com/) table.

> Errors for creating a geostore object

Error code     | Error message  | Description
-------------- | -------------- | --------------
400            | `<field>`: `<field>` can not be empty | Your are missing a required field value.
400            | `<field>`: empty or invalid `<field>` | The provided value for `<field>` is invalid. This is usually happens if an invalid value type is provided, but certain fields use more advanced validation rules, that may produce this error message if validation fails (ie: `geojson`, which must be `type:` `FeatureCollection`, `Feature`, or `Geometry`).
400            | provider: must be valid <list of valid providers> | Your `provider` `type` value is invalid. The `<list of valid providers>` will contain the list of providers that are supported.

### Create using a GeoJSON

Geostore objects can be created via the POST `geostore` endpoint, which accepts as body a GeoJSON object (`<geojson>`). This must be a `FeatureCollection`, `Feature` or `Geometry`. If the object is correctly added to the Geostore a `200` response is returned, as well as the new geostore object.

> Example request pattern

```shell
curl -X POST https://api.resourcewatch.org/v1/geostore/ \
     -H "Content-Type: application/json" \
     -d '{"geojson": <geojson>}'
```

> Example URL request

```shell
curl --location --request POST 'https://api.resourcewatch.org/v1/geostore' \
--header 'Content-Type: application/json' \
--data-raw '{
   "geojson":{
      "type":"FeatureCollection",
      "features":[
         {
            "type":"Feature",
            "properties":{

            },
            "geometry":{
               "type":"Polygon",
               "coordinates":[
                  [
                     [
                        -4.4549560546875,
                        40.84706035607122
                     ],
                     [
                        -4.4549560546875,
                        41.30257109430557
                     ],
                     [
                        -3.5211181640624996,
                        41.30257109430557
                     ],
                     [
                        -3.5211181640624996,
                        40.84706035607122
                     ],
                     [
                        -4.4549560546875,
                        40.84706035607122
                     ]
                  ]
               ]
            }
         }
      ]
   }
}'
```

> Example response

```json
{
    "data": {
        "type": "geoStore",
        "id": "4b25676360d8bbd5106a022103e0cd28",
        "attributes": {
            "geojson": {
                "crs": {},
                "type": "FeatureCollection",
                "features": [
                    {
                        "geometry": {
                            "coordinates": [
                                [
                                    [
                                        -4.454956055,
                                        40.847060356
                                    ],
                                    [
                                        -4.454956055,
                                        41.302571094
                                    ],
                                    [
                                        -3.521118164,
                                        41.302571094
                                    ],
                                    [
                                        -3.521118164,
                                        40.847060356
                                    ],
                                    [
                                        -4.454956055,
                                        40.847060356
                                    ]
                                ]
                            ],
                            "type": "Polygon"
                        },
                        "type": "Feature"
                    }
                ]
            },
            "hash": "4b25676360d8bbd5106a022103e0cd28",
            "provider": {},
            "areaHa": 397372.34118232,
            "bbox": [
                -4.454956055,
                40.847060356,
                -3.521118164,
                41.302571094
            ],
            "lock": false,
            "info": {
                "use": {}
            }
        }
    }
}
```

### Create using a provider definition

Geostore objects can be created via the POST `geostore` endpoint, which accepts as body a provider definition object (`<provider>`), the API then fetches a GeoJSON from the provider, and adds it to the Geostore. If the object is correctly added to the Geostore a `200` response is returned, as well as the new geostore object. At present the only provider definition supported is a [Carto](https://carto.com/) table, using `"type": "carto"`.

If the specified `table`, `user`, or `filter` is not recognized a `400` response is returned with the error message "Geojson not found".

> Overview of provider object

| Field    | Type   | Description                |
|----------|--------|----------------------------|
| `type`   | string | Keyword of the provider    |
| `table`  | string | Name of the provider table |
| `user`   | string | Provider username          |
| `filter` | string | Provider specific filter   |

> Example request pattern

```shell
curl -X POST https://api.resourcewatch.org/v1/geostore \
-H "Content-Type: application/json" \
-d '{"provider": <provider>}'
```

> Example URL request

```shell
curl -X POST https://api.resourcewatch.org/v1/geostore \
-H "Content-Type: application/json" \
-d '{
        "provider":{
            "type": "carto",
            "table": "gfw_mining",
            "user": "wri-01",
            "filter": "cartodb_id=573"
        }
    }'
```

> Example response

```json
{
  "data": {
    "type": "geoStore",
    "id": "b3b2875affa75f145b4f3e5289fd47d7",
    "attributes": {
      "geojson": {
        "crs": {},
        "type": "FeatureCollection",
        "features": [
          {
            "geometry": {
              "coordinates": [
                [
                  14.26438308756265,
                  14.062500000000002
                ],
                [
                  5.266007882805498,
                  2.8125
                ],
                [
                  44.84029065139799,
                  16.523437500000004
                ],
                [
                  -7.362466865535738,
                  -3.1640625000000004
                ],
              ],
              "type": "MultiPoint"
            },
            "type": "Feature",
            "properties": null
          }
        ]
      },
      "hash": "b3b2875affa75f145b4f3e5289fd47d7",
      "provider": {
        "type": "carto",
        "table": "gfw_mining",
        "user": "wri-01",
        "filter": "cartodb_id=573"
      },
      "areaHa": 0,
      "bbox": [
        -102.65625,
        -29.688052749856787,
        45.87890625,
        57.79794388498275
      ],
      "lock": false,
      "info": {
        "use": {}
      }
    }
  }
}
```

## Getting geostore objects

The fundamental way to read geometries from the RW APIs Geostore is by using Geostore ids. Using these identifiers you can ensure that you are always [retrieving exactly the same `Feature`](#geostore-objects). If you [add your own geostore objects](#create-a-geostore-object) you will be using [these endpoints](#get-geostore-by-geostore-id).

Alternatively you may prefer to get selected geometries from the datasets already added to the RW API Geostore, such as the [latest administrative areas, protected areas, or land use types](#overview-of-available-endpoints). Note, these are periodically updated, and potentially both geometries and ids may change between versions. By design this means that, for example, the Geostore ids of countries change between versions. These geometries can also be simplified when reading them from the Geostore, using the parameter `?simplify=<value>`, where `<value>` is given to the simplification algorithm - `0.005` usually works well.

### Get a geostore object by Geostore id

Geostore objects can be retrieved via the GET `geostore/:id` endpoint, which returns a single object selected from the Geostore using a single [Geostore id](#geostore) (`<id>`).

> Example request pattern

```shell
curl -X GET https://api.resourcewatch.org/v2/geostore/<id>
```

> Example URL request

```shell
curl -X GET https://api.resourcewatch.org/v2/geostore/ca38fa80a4ffa9ac6217a7e0bf71e6df
```

> Example response

```json
{
    "data": {
        "type": "geoStore",
        "id": "ca38fa80a4ffa9ac6217a7e0bf71e6df",
        "attributes": {
            "geojson": {
                "crs": {},
                "type": "FeatureCollection",
                "features": [
                    {
                        "type": "Feature",
                        "geometry": {
                            "type": "Polygon",
                            "coordinates": [
                                [
                                    [
                                        -5.273512601852417,
                                        42.81137220349083
                                    ],
                                    [
                                        -5.273512601852417,
                                        42.811803118457306
                                    ],
                                    [
                                        -5.272732079029083,
                                        42.811803118457306
                                    ],
                                    [
                                        -5.272732079029083,
                                        42.81137220349083
                                    ],
                                    [
                                        -5.273512601852417,
                                        42.81137220349083
                                    ]
                                ]
                            ]
                        }
                    }
                ]
            },
            "hash": "ca38fa80a4ffa9ac6217a7e0bf71e6df",
            "provider": {},
            "areaHa": 0.3057556230214663,
            "bbox": [
                -5.273512601852417,
                42.81137220349083,
                -5.272732079029083,
                42.811803118457306
            ],
            "lock": false,
            "info": {
                "use": {}
            }
        }
    }
}
```

#### Errors for getting geostore objects by id

Error code     | Error message       | Description
-------------- | ------------------- | -----------------------------------------------
404            | Geostore not found. | A geostore with the id provided was not found.

### Get geostore by Geostore id and view at GeoJSON.io

Geostore objects can be retrieved and viewed via the GET `geostore/:id/view` endpoint, which returns a URL allowing viewing of a single geostore object selected by [Geostore id](#geostore-id) (`<id>`)  at GeoSON.io.

> Example request pattern

```shell
curl -X GET https://api.resourcewatch.org/v2/geostore/<id>/view
```

> Example URL request

```shell
curl -X GET https://api.resourcewatch.org/v2/geostore/ca38fa80a4ffa9ac6217a7e0bf71e6df/view
```

> Example response

```json
{
    "view_link": "http://geojson.io/#data=data:application/json,%7B%22crs%22%3A%7B%7D%2C%22type%22%3A%22FeatureCollection%22%2C%22features%22%3A%5B%7B%22type%22%3A%22Feature%22%2C%22geometry%22%3A%7B%22type%22%3A%22Polygon%22%2C%22coordinates%22%3A%5B%5B%5B-5.273512601852417%2C42.81137220349083%5D%2C%5B-5.273512601852417%2C42.811803118457306%5D%2C%5B-5.272732079029083%2C42.811803118457306%5D%2C%5B-5.272732079029083%2C42.81137220349083%5D%2C%5B-5.273512601852417%2C42.81137220349083%5D%5D%5D%7D%2C%22properties%22%3Anull%7D%5D%7D"
}
```

#### Errors for viewing geostore objects by id

Error code     | Error message       | Description
-------------- | ------------------- | -----------------------------------------------
400            | Geometry too large, please try again with a smaller geometry. | The Geostore provided is too large (more than 150k chars when stringified) and cannot be viewed.
404            | Geostore not found. | A geostore with the id provided was not found.

### Get geostore objects by Geostore ids

Many geostore objects can be retrieved via the POST `geostore/find-by-ids` endpoint, which returns an array of a geostore objects selected by an array of [Geostore ids](#geostore-objects) (`[<id>, <id>]`). In case of success, the returned response will contain an array with all of the geostore objects found and summary info is available in the root property `info`.

> Example request pattern

```shell
curl -X POST https://api.resourcewatch.org/v2/geostore/find-by-ids \
     -H "Content-Type: application/json" \
     -d '{"geostores": [<id>, <id>]}'
```

> Example URL request

```shell
curl -X POST https://api.resourcewatch.org/v2/geostore/find-by-ids \
     -H "Content-Type: application/json" \
     -d '{"geostores": ["35a6d982388ee5c4e141c2bceac3fb72", "8f77fe62cf15d5098ba0ee11c5126aa6"]}'
```

> Example response (coordinates are truncated)

```json
{
    "data": [
        {
            "geostoreId": "35a6d982388ee5c4e141c2bceac3fb72",
            "geostore": {
                "data": {
                    "type": "geoStore",
                    "id": "35a6d982388ee5c4e141c2bceac3fb72",
                    "attributes": {
                        "geojson": {
                            "crs": {},
                            "type": "FeatureCollection",
                            "features": [
                                {
                                    "geometry": {
                                        "coordinates": [
                                            ...
                                        ],
                                        "type": "MultiPolygon"
                                    },
                                    "type": "Feature"
                                }
                            ]
                        },
                        "hash": "35a6d982388ee5c4e141c2bceac3fb72",
                        "provider": {},
                        "areaHa": 50662609.25209112,
                        "bbox": [
                            -18.1604175567627,
                            27.6384716033936,
                            4.32819509506226,
                            43.7915267944337
                        ],
                        "lock": false,
                        "info": {
                            "use": {},
                            "iso": "ESP",
                            "name": "Spain"
                        }
                    }
                }
            }
        },
        {
            "geostoreId": "8f77fe62cf15d5098ba0ee11c5126aa6",
            "geostore": {
                "data": {
                    "type": "geoStore",
                    "id": "8f77fe62cf15d5098ba0ee11c5126aa6",
                    "attributes": {
                        "geojson": {
                            "crs": {},
                            "type": "FeatureCollection",
                            "features": [
                                {
                                    "geometry": {
                                        "coordinates": [
                                            ...
                                        ],
                                        "type": "MultiPolygon"
                                    },
                                    "type": "Feature"
                                }
                            ]
                        },
                        "hash": "8f77fe62cf15d5098ba0ee11c5126aa6",
                        "provider": {},
                        "areaHa": 54935531.53854849,
                        "bbox": [
                            -5.14375114440907,
                            41.3337516784668,
                            9.5604162216186,
                            51.08939743042
                        ],
                        "lock": false,
                        "info": {
                            "use": {},
                            "iso": "FRA",
                            "name": "France"
                        }
                    }
                }
            }
        }
    ],
    "info": {
        "found": 2,
        "foundIds": [
            "35a6d982388ee5c4e141c2bceac3fb72",
            "8f77fe62cf15d5098ba0ee11c5126aa6"
        ],
        "returned": 2
    }
}
```

#### Errors for getting multiple geostore objects by id

Error code     | Error message       | Description
-------------- | ------------------- | -----------------------------------------------
404            | Geostore not found. | A geostore with the id provided was not found.


### Get all Geostore ids, names and country codes

All of the Geostore ids, names, and country ISO 3166-1 alpha-3 code values available from the GADM data source in the Geostore can be retrieved via the GET `geostore/admin/list` endpoint, which returns an array of objects with the properties `geostoreId`, `name`, and `iso`.

> Example URL request

```shell
curl -X GET https://api.resourcewatch.org/v2/geostore/admin/list
```

> Example response

```json
{
    "data": [{
        "geostoreId": "35a6d982388ee5c4e141c2bceac3fb72",
        "iso": "ESP",
        "name": "Spain"
    }, {
        "geostoreId": "8f77fe62cf15d5098ba0ee11c5126aa6",
        "iso": "FRA",
        "name": "France"
    }, {
        "geostoreId": "1d568c183033da6c17cc28c4aecf1bcf",
        "iso": "cod",
        "name": "Democratic Republic of the Congo"
    }]
}
```

*Note - This endpoint does not return a unique array of iso codes and names.*

### Get geostore by country code

Geostore objects can be retrieved via the GET `geostore/admin/:iso` endpoint, which returns a single object selected from the Geostore using a single  country [ISO 3166-1 alpha-3 code](https://en.wikipedia.org/wiki/ISO_3166-1_alpha-3) (`<iso>`). The returned geometries can be simplified using the parameter `?simplify=<value>`. Where `<value>` is given to the simplification algorithm, 0.005 usually works well.

*Note - The source of the geometries is GADM version 3.6.*

> Example request pattern

```shell
curl -X GET https://api.resourcewatch.org/v2/geostore/admin/<iso>simplify=<value>
```

> Example URL request

```shell
curl -X GET https://api.resourcewatch.org/v2/geostore/admin/ESP
```

> Example response (note coordinates are truncated)

```json
{
    "data": {
        "type": "geoStore",
        "id": "56f9a919e061d5edd10c042a8fcd31b6",
        "attributes": {
            "geojson": {
                "crs": {},
                "type": "FeatureCollection",
                "features": [
                    {
                        "geometry": {
                            "coordinates": [
                                ...
                            ],
                            "type": "MultiPolygon"
                        },
                        "type": "Feature",
                        "properties": null
                    }
                ]
            },
            "hash": "56f9a919e061d5edd10c042a8fcd31b6",
            "provider": {},
            "areaHa": 50662609.2516529,
            "bbox": [
                -18.160417557,
                27.638471603,
                4.328195095,
                43.791526794
            ],
            "lock": false,
            "info": {
                "use": {},
                "iso": "ESP",
                "id1": null,
                "id2": null,
                "gadm": "2.8",
                "name": "Spain"
            }
        }
    }
}
```

#### Errors for getting geostore objects by country code

Error code     | Error message       | Description
-------------- | ------------------- | -----------------------------------------------
404            | Geostore not found. | A geostore for the country ISO code provided was not found.

### Get geostore by country code and GADM admin 1 id

Geostore objects can be retrieved via the GET `geostore/admin/:iso/:id1` endpoint, which returns a single object selected from the Geostore using a single country [ISO 3166-1 alpha-3 code](https://en.wikipedia.org/wiki/ISO_3166-1_alpha-3) (`<iso>`) and [GADM admin level 1](https://gadm.org/metadata.html) id (`<id1>`). The returned geometries can be simplified using the parameter `?simplify=<value>`. Where `<value>` is given to the simplification algorithm, 0.005 usually works well.

*Note - The source of the geometries is GADM version 3.6.*

> Example request pattern

```shell
curl -X GET https://api.resourcewatch.org/v2/geostore/admin/<iso>/<id1>
```

> Example URL request

```shell
curl -X GET https://api.resourcewatch.org/v2/geostore/admin/ESP/9
```

> Example response (note coordinates are truncated)

```json
{
    "data": {
        "type": "geoStore",
        "id": "7d1534d7c24b2f907c4ae37d11fc51fe",
        "attributes": {
            "geojson": {
                "crs": {},
                "type": "FeatureCollection",
                "features": [
                    {
                        "geometry": {
                            "coordinates": [
                                ...
                            ],
                            "type": "MultiPolygon"
                        },
                        "type": "Feature",
                        "properties": null
                    }
                ]
            },
            "hash": "7d1534d7c24b2f907c4ae37d11fc51fe",
            "provider": {},
            "areaHa": 1036273.8136673134,
            "bbox": [
                -2.500030994,
                41.909896851,
                -0.726752043,
                43.314189911
            ],
            "lock": false,
            "info": {
                "use": {},
                "iso": "ESP",
                "id1": 9,
                "id2": null,
                "gadm": "2.8"
            }
        }
    }
}
```

#### Errors for getting geostore objects by country code and GADM admin 1 id

Error code     | Error message       | Description
-------------- | ------------------- | -----------------------------------------------
404            | Geostore not found. | A geostore for the combination of country ISO code and GADM admin 1 id provided was not found.

### Get geostore by country code, GADM admin 1 and admin 2 ids

GeoStore objects can be retrieved via the GET `geostore/admin/:iso/:id1/:id2` endpoint, which returns a single object selected from the Geostore using a single country [ISO 3166-1 alpha-3 code](https://en.wikipedia.org/wiki/ISO_3166-1_alpha-3) (`<iso>`),  [GADM admin level 1](https://gadm.org/metadata.html) id (`<id1>`), and [GADM admin level 2](https://gadm.org/metadata.html) id (`<id2>`). The returned geometries can be simplified using the parameter `?simplify=<value>`. Where `<value>` is given to the simplification algorithm, 0.005 usually works well.

*Note - The source of the geometries is GADM version 3.6.*

> Example request pattern

```shell
curl -X GET https://api.resourcewatch.org/v2/geostore/admin/<iso>/<id1>/<id2>
```

> Example URL request

```shell
curl -X GET https://api.resourcewatch.org/v2/geostore/admin/ESP/1/2
```

> Example response

```json
{
    "data": {
        "type": "geoStore",
        "id": "214e74a9e8702f78354ed5cb0297c10d",
        "attributes": {
            "geojson": {
                "crs": {},
                "features": [
                    {
                        "geometry": {
                            "coordinates": [...],
                            "type": "MultiPolygon"
                        },
                        "properties": null,
                        "type": "Feature"
                    }
                ],
                "type": "FeatureCollection"
            },
            "hash": "214e74a9e8702f78354ed5cb0297c10d",
            "provider": {},
            "areaHa": 744195.8099038196,
            "bbox": [
                -6.47347212,
                35.9995842,
                -5.08662891,
                37.05246735
            ],
            "lock": false,
            "info": {
                "use": {},
                "simplifyThresh": 0.00005,
                "gadm": "3.6",
                "name": "CÃ¡diz",
                "id2": 2,
                "id1": 1,
                "iso": "ESP"
            }
        }
    }
}
```

#### Errors for getting geostore objects by country code, GADM admin 1 id and admin 2 id

Error code     | Error message       | Description
-------------- | ------------------- | -----------------------------------------------
404            | Geostore not found. | A geostore for the combination of country ISO code, GADM admin 1 id and admin 2 id provided was not found.

### Get geostore by World Database on Protected Areas id

Geostore objects can be retrieved via the GET `geostore/admin/wdpa/:id` endpoint, which returns a single object selected from the Geostore using a single [World Database on Protected Areas](https://www.protectedplanet.net/) (WDPA) id (`<id>`). To find valid WDPA id values check the link above.

*Note marine protected areas are NOT included*

[TODO: Give details about the dataset update frequency]

> Example request pattern

```shell
curl -X GET https://api.resourcewatch.org/v2/geostore/wdpa/<id>
```

> Example URL request

```shell
curl -X GET https://api.resourcewatch.org/v2/geostore/wdpa/142809
```

> Example response (note coordinates are truncated)

```json
{
    "data": {
        "type": "geoStore",
        "id": "88db597b6bcd096fb80d1542cdc442be",
        "attributes": {
            "geojson": {
                "crs": {},
                "type": "FeatureCollection",
                "features": [
                    {
                        "geometry": {
                            "coordinates": [
                                ...
                                ],
                            "type": "MultiPolygon"
                        },
                        "type": "Feature",
                        "properties": null
                    }
                ]
            },
            "hash": "88db597b6bcd096fb80d1542cdc442be",
            "provider": {},
            "areaHa": 5081.838068566336,
            "bbox": [
                -6.031685272,
                36.160220287,
                -5.879245686,
                36.249656987
            ],
            "lock": false,
            "info": {
                "use": {},
                "wdpaid": 142809
            }
        }
    }
}
```

#### Errors for getting geostore objects by WDPA id

Error code     | Error message       | Description
-------------- | ------------------- | -----------------------------------------------
404            | Geostore not found. | A geostore for the WDPA id provided was not found.

### Get geostore by Land Use Type keyword and id

Geostore objects can be retrieved via the GET `geostore/admin/use/:name/:id` endpoint, which returns a single object selected from the Geostore using a single [Land Use Type](#land-use-types) keyword (`<name>`) and  Land Use Type object id (`<id>`). Geostore objects for five land use types are available; Tiger conservation landscapes (`tiger_conservation_landscapes`), Oil Palm production (`oilpalm`), Mining activities (`mining`), Wood fiber production (`fiber`), and Forest logging activities (`logging`). The returned geometries can be simplified using the parameter `?simplify=<value>`. Where `<value>` is given to the simplification algorithm, 0.005 usually works well.

*Note - each of the land use types actually represents an individual dataset, each with different geographical extents and temporal coverage, see the [dataset urls](#overview-of-available-endpoints) for details*  

> Example request pattern

```shell
curl -X GET https://api.resourcewatch.org/v2/geostore/use/<name>/<id>
```

> Example URL request

```shell
curl -X GET https://api.resourcewatch.org/v2/geostore/use/logging/1
```

> Example response (note coordinates are truncated)

```json
{
    "data": {
        "type": "geoStore",
        "id": "bd5feac1b0dd4e73f3a1553889807622",
        "attributes": {
            "geojson": {
                "crs": {},
                "type": "FeatureCollection",
                "features": [
                    {
                        "geometry": {
                            "coordinates": [...],
                            "type": "MultiPolygon"
                        },
                        "type": "Feature",
                        "properties": null
                    }
                ]
            },
            "hash": "bd5feac1b0dd4e73f3a1553889807622",
            "provider": {},
            "areaHa": 45978.43408272762,
            "bbox": [
                102.691404026,
                -0.248440312,
                103.036606,
                -0.071735991
            ],
            "lock": false,
            "info": {
                "use": {
                    "use": "gfw_logging",
                    "id": 1
                },
                "simplify": false
            }
        }
    }
}
```

#### Errors for getting geostore objects by land use type

Error code     | Error message       | Description
-------------- | ------------------- | -----------------------------------------------
404            | Geostore not found. | A geostore for the specified `<name>` and `<id>` was not found.

## Calculate the area of a geostore object

If you have a GeoJSON geometry and you intend to know the area that your geometry occupies or what is the bounding box for your geometry, you can use the POST `v2/geostore/area` endpoint to calculate the area of your geometry.

> Example request pattern

```shell
curl -X POST https://api.resourcewatch.org/v2/geostore/area \
  -d '{"geojson": <geojson>}'
```

> Example URL request

```shell
curl -X POST https://api.resourcewatch.org/v2/geostore/area \
  -d '{
      "geojson":{
        "type": "Polygon",
        "coordinates": [
            [
                [-0.1758,51.2894],
                [8.4375,51.1793],
                [6.8555,47.5172],
                [-0.1758,51.2894]
            ]
        ]
    }}'
```

> Example response:

```json
{
    "data": {
        "type": "geomArea",
        "attributes": {
            "bbox": [
                -0.1758,
                47.5172,
                8.4375,
                51.2894
            ],
            "areaHa": 12797498.414088473
        }
    }
}
```

#### Errors for calculating the area of a geostore object

Error code     | Error message       | Description
-------------- | ------------------- | -----------------------------------------------
400            | `geojson, esrijson or provider required.` | You need to provide the GeoJSON for the geometry you intend to calculate the area.
